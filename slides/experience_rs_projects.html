<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>An Introduction to Reproducible Analyses in R: With previous experience.</title>
    <meta charset="utf-8" />
    <meta name="author" content="Emma Rand" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="..\css_files\emma.css" type="text/css" />
    <link rel="stylesheet" href="..\css_files\emma-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">










class: inverse

# Introduction to Reproducibility in R 

## For those with previous experience: RStudio Projects.

### Emma Rand 

### University of York: 2020-03-19

.footnote[
Made with xaringan &lt;a name=cite-xaringan&gt;&lt;/a&gt;([Xie, 2019](#bib-xaringan))  

&lt;a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"&gt;&lt;img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /&gt;&lt;/a&gt;&lt;br /&gt;&lt;span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"&gt;White Rose BBSRC Doctoral Training Partnership (DTP) in Mechanistic Biology Analytics 1: Introduction to reproducible analyses in R&lt;/span&gt; by &lt;span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName"&gt;Emma Rand&lt;/span&gt; is licensed under a &lt;a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"&gt;Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License&lt;/a&gt;.
]


---
# Introduction

## Aims

The aim of this section is to show you how to organise your work in a logical, consistent and reproducible way using RStudio Projects, appropriate directory structures and portable code. It will set you up for the [Tidying data and the tidyverse including the pipe]() and [Advanced Data Import]() sections.

## Learning outcomes 

The successful student will be able to:

* use RStudio projects to appropriately organise a piece of work  
* write code with relative paths given appropriate to your project organisation  
* write dataframes and figures to file  

### ðŸŽ¬ An instruction to do something!!

---
# What is a path?

A path gives the location of a filesystem object (i.e., a file, directory or link).

* An *Absolute* path is given from the root directory of the object, for example the absolute path for a file, `beewing.txt` is:  
  * windows: `M:/web/58M_BDS_2019/data/beewing.txt`  
  * unix systems: `/users/er13/web/58M_BDS_2019/data/beewing.txt`  
  * web: `http://www-users.york.ac.uk/~er13/58M_BDS_2019/data/beewing.txt`  

* A *Relative* path gives the location of a filesystem object relative to the working directory, for example when `beewing.txt` is in:  
  * the working directory (wd):  `beewing.txt`  
  * a directory called 'data' which is in the wd: `data/beewing.txt`  
  * the directory above the wd: `../beewing.txt`  
  * a directory called 'data' which is in the directory above the wd: `../data/beewing.txt`  

More if you need it: [What do we mean by paths?](https://youtu.be/oZblx36rqq0) 

---
# Using RStudio projects

An [RStudio project](https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects) is associated with a directory. 

Using a project helps you manage file paths. The working directory is the project directory (i.e., the location of the .Rproj file). Read both of these instructions and the view the next slides before doing anything.

ðŸŽ¬ Create a new project with File | New Project and chose New directory and then New project.I suggest naming it `wr_analytics` or similar.

ðŸŽ¬ Be purposeful about where you create it by using the Browse button. Don't have `~` in the lower box! See next! 

---
# Using RStudio projects

## Don't have `~` in the lower box!
.pull-left[
....by navigating to your file store though the actual links starting `(\\userfs)(M:)` or similar not the shortcuts starting `This PC`:
]
.pull-right[
![screen short of windows explorer with actual links highlighted](../pics/noshortcut.png)
]

---
# Using RStudio projects

Creating a new project will:

1. Create a directory (folder) called `wr_analytics`
2. Restart RStudio in that directory and set your working directory to `wr_analytics` (i.e., it loads the project)
3. Create a `wr_analytics.Rproj` file within the project directory. This file contains various project options.  
4. Create a hidden directory (named .Rproj.user) where project-specific temporary files are stored.  

--

Note that `getwd()` will return `wr_analytics`

--

Suggested reading [Chapter 2 Project-oriented workflow](https://whattheyforgot.org/project-oriented-workflow.html) of What they forgot to teach you about R &lt;a name=cite-Bryan-Hester&gt;&lt;/a&gt;([Bryan and Hester, b](#bib-Bryan-Hester))

---
# Directory structure

ðŸŽ¬ Create folders in `wr_analytics` called `raw_data`, `processed_data` and `figures`.

ðŸŽ¬ Start new scripts called `tidy.R`, `import.R` and `figures.R`

ðŸŽ¬ Load the tidyverse set of packages.

```r
library(tidyverse)
```


---
# Writing files

Often we want to write to files. My main reasons for doing so are to save copies of data that have been processed and to save graphics. 

You will import a simple data file, reshape the data and write it to file. You will also produce a simple figure and save that to file.

ðŸŽ¬ Save a copy of [pigeon.txt](../data/pigeon.txt) to your `raw_data` folder. These data give the interorbital distances for two populations of domestic pigeons.


ðŸŽ¬ Using your `import.R` script, read in the file:


```r
pigeon &lt;- read.table("raw_data/pigeon.txt", header = TRUE)
```

---
# Writing files

This dataset has two observations in a row - it is not 'tidy'. 

ðŸŽ¬ Reshape the data using:


```r
pigeon &lt;- pigeon %&gt;% 
  gather(key = population, value = distance)
```

We will cover the pipe, ` %&gt;% ` in the next section, [Tidying data and the tidyverse including the pipe]()


ðŸŽ¬ Write your dataframe called `pigeon` to a plain text file you will name `pigeon_long.txt` in your `processed_data` folder:

```r
file &lt;- "processed_data/pigeon_long.txt"
write.table(pigeon, file)
```

---
# Writing files

## Create a plot to save

ðŸŽ¬ Create a simple plot of this data:
.pull-left[

```r
fig1 &lt;- ggplot(data = pigeon, 
               aes(x = population, y = distance)) + 
  geom_boxplot() +                            
  scale_x_discrete(name = "Population") +
  scale_y_continuous(name = "Interorbital distance (mm)",
                     expand = c(0, 0),
                     limits = c(0, 15)) +
  theme_classic()
```
]
.pull-right[
![](experience_rs_projects_files/figure-html/unnamed-chunk-6-1.png)&lt;!-- --&gt;

]

---
# Writing files

## Saving `ggplot` figures

A useful function for save figures is `ggsave()`. 

It has arguments for the size, resolution and device for the image. See the [`ggsave()` reference page](https://ggplot2.tidyverse.org/reference/ggsave.html). 

Since I often make more than one figure, I might set these arguments first.

ðŸŽ¬ Assign `ggsave` argument values to variables:


```r
# figure saving settings
units = "in"  
fig_w &lt;- 3.2
fig_h &lt;- fig_w
dpi &lt;- 300
device &lt;- "tiff" 
```
"tiff" is a format often required by journals; you may want png or jpg.

---
# Writing files

## Saving `ggplot` figures

ðŸŽ¬ Save the `figure` in your figures directory:


```r
ggsave("figures/fig1.tiff",
       plot = fig1,
       device = device,
       width = fig_w,
       height = fig_w,
       units = units,
       dpi = dpi)
```





---
# References

&lt;a name=bib-Bryan-Hester&gt;&lt;/a&gt;[Bryan, J. and J.
Hester](#cite-Bryan-Hester) _Chapter 2 Project-oriented workflow |
What They Forgot to Teach You About R_. &lt;URL:
https://whattheyforgot.org/project-oriented-workflow.html&gt;.
Accessed: 2019-9-26.

&lt;a name=bib-xaringan&gt;&lt;/a&gt;[Xie, Y.](#cite-xaringan) (2019).
_xaringan: Presentation Ninja_. R package version 0.12. URL:
[https://CRAN.R-project.org/package=xaringan](https://CRAN.R-project.org/package=xaringan).



---
background-image: url(pics/Royal_Society_of_Biology.png)
background-position: 0.5% 0.5%
background-size: 350px

class: inverse

# Congratulations! Keep practising!

Emma Rand 

emma.rand@york.ac.uk

Twitter: [@er13_r](https://twitter.com/er13_r) 

github: [3mmaRand](https://github.com/3mmaRand)

blog: https://buzzrbeeline.blog/
&lt;br&gt;

.footnote[
&lt;a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"&gt;&lt;img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /&gt;&lt;/a&gt;&lt;br /&gt;&lt;span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"&gt;White Rose BBSRC Doctoral Training Partnership (DTP) in Mechanistic Biology Analytics 1: Introduction to reproducible analyses in R&lt;/span&gt; by &lt;span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName"&gt;Emma Rand&lt;/span&gt; is licensed under a &lt;a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"&gt;Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License&lt;/a&gt;.
]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
