---
title: "Introduction to R and working with data."
subtitle: "White Rose BBSRC DTP Training: An Introduction to Reproducible Analyses in R."
author: "Emma Rand"
institute: "University of York, UK"
output:
  xaringan::moon_reader:
    css: [default, ../css_files/emma.css, ../css_files/emma-fonts.css]
    lib_dir: libs
    seal: true
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, 
                      message = FALSE,	
                      warning = FALSE,
                      fig.width=4, 
                      fig.height=4, 
                      fig.retina=3)
options(htmltools.dir.version = FALSE)
```

```{r packages, include=FALSE}
library(RefManageR)
library(kableExtra)
library(tidyverse)
```


```{r, load-refs, include=FALSE, cache=FALSE}
BibOptions(check.entries = FALSE,
           bib.style = "authoryear",
           cite.style = "authoryear",
           style = "markdown",
           hyperlink = TRUE,
           dashed = FALSE,
           longnamesfirst = FALSE,
           max.names = 2)
myBib <- ReadBib("../refs.bib", check = FALSE)
```


background-image: url(../pics/tidyverse_logo.png)
background-position: 100% 80%
background-size: 180px

# Overview
.font140[
* Finding your way round RStudio  
* Typing in data, doing some calculations on it, plotting it
* Understanding the manual  
* Working with a data  
  * Importing data: working directories and paths  
  * Summarising and visualising with the [`tidyverse`](https://www.tidyverse.org/)  
* Installing and loading packages
]
---

class: inverse

#  Finding your way round RStudio
---

# Finding your way round RStudio

## Live demonstration

Overview [Larger](http://www-users.york.ac.uk/~er13/RStudio%20Anatomy.svg)

```{r, echo=FALSE, out.width = "600px"}
knitr::include_graphics("http://www-users.york.ac.uk/~er13/RStudio%20Anatomy.svg")
```


There is an [RStudio cheatsheet](http://www-users.york.ac.uk/~er13/rstudio-ide.pdf) which covers more advanced RStudio features.

---

# Finding your way round RStudio

## Live demonstration

* the panels
* making yourself comfortable
* typing in the console sending commands
* using R as a calculator
* assigning values
* where to see objects
* using a script - typing doesn't make it happen you need to execute
* comments \#
* data types and structures
* functions `c()`, `class()` and `str()`
* types of of R files: .R, .RData . RHistory


---
# Finding your way round RStudio

## Summary of live demonstration: <mark style="background-color: #b0cdef">The panels</mark>

.pull-left[
Top left
* Script - where you write, edit and save code and comments you want to keep  
  
---
Bottom left  
* console - commands get executed here and can be typed here  
]

.pull-right[
Top right
* Environment - where to see your objects  
* History - a list of every command you sent  
--- 
Bottom right  
* Files - a file explorer  
* Packages - the packages you have installed and a method of installing packages  
* Help - the manual  
* Plots - where your plots go  
]

---
# Finding your way round RStudio

## Summary of Live demonstration: <mark style="background-color: #b0cdef">Types of R files</mark>

* .R 
  a script file:  code (to save) and comments
* .RData  
  a environment file also know as a workspace: objects but no code
* .RHistory  (everything you typed, mostly wrong!)
 
### Using a script 
* any R code can be executed from a script
* code can be (should be!) commented  
* comments start with a `#`

---
# Finding your way round RStudio

## Summary of Live demonstration: <mark style="background-color: #b0cdef">Data types and structures</mark>

These are the most commonly needed but there are others
.pull-left[
Types
* numeric
* integer
* logical
* character
]
.pull-right[
Structures
* vectors
* factors
* dataframes
]

---

class: inverse

# Typing in data, doing some calculations on it, plotting it

---
# Typing in data, calcs, plots

## The goal
We will work some data on the number of males in 64 bird nests with a clutch size of 5.
--
.pull-left[
You are going to make this data, find the mean number of males per nest...
```{r , echo=FALSE}
n <- c(0, 1, 2, 3, 4, 5)
freq <- c(4, 13, 14, 15, 13, 5)
df <- data.frame(n, freq)
knitr::kable(df, 
             format = "html",
             col.names = c("No. males", "No. nests"),
             row.names = FALSE)
```
]
--
.pull-right[
... and make a plot


```{r , echo=FALSE}
nest_data <- data.frame(n = factor(n), freq)
ggplot(data = nest_data, aes(x = n, y = freq)) +
  geom_col(colour = "black", fill = "white", width = 1) +
  scale_x_discrete(name = "Number of males",
                   expand = c(0, 0)) +
  scale_y_continuous(name = "Number of nests",
                     expand = c(0,0)) +
  theme_classic()
```
]


---
# Typing in data, calcs, plots

## Getting set up

In RStudio do File | New project | New directory

Be purposeful about where you create it and name it.

I suggest `birds.`

--

Make a new script using the new file button ![new script](../pics/newscript.png) and save it as analysis.R to carry out the rest of the work.  



---
# Typing in data, calcs, plots

## Putting the data into R data structures

Make a vector `n` that holds the numbers 0 to 5. 
```{r}
# the number of males in a clutch of five
n <- c(0, 1, 2, 3, 4, 5)
```

* Write your command in the script file  

--

* Notice I have used a comment  
--

* Make sure you have your cursor on the line you want to execute  

--

* Run it using the run button ![Run](../pics/runbutton.png) or doing Ctrl+Enter<sup>1</sup>. 

.footnote[
[1] Ctrl+Enter is the default shortcut to run the current line or selection. I prefer to set to Ctrl+R]

---
# Typing in data, calcs, plots

## Putting the data into R data structures

Let's take a look at it using `str()` (structure) and `class()`<sup>1</sup>:

.footnote[
[1] These commands are useful to check what data type you're working with.
]

--

```{r}
class(n)
```

--

```{r}
str(n)
```

It's a numeric vector.
 


---
# Typing in data, calcs, plots

## Putting the data into R data structures

Now create a vector called `freq` containing the numbers of nests with 0 to 5 males. 

```{r}
# the number of nests with 0 to 5 males
freq <- c(4, 13, 14, 15, 13, 5)
```
--
We can use `sum(freq)` to check we get the total number of nests expected, 64

```{r}
# the total number of nests
sum(freq)
```

---
# Typing in data, calcs, plots

## Finding the mean
Our data is in the form of a frequency table so to find the mean number of males per nest we need find the total number of males like this:
.pull-left[
```{r , echo=FALSE}
df$product <- df$n * df$freq
totalm <- sum(df$product)
totaln <- sum(df$freq)
dfchar <- df %>%
  mutate_all(as.character)
dfchar <- rbind(dfchar, c("Total", totaln, totalm))
dfchar %>% kable(format = "html",
                 col.names = c("No. males", "No. nests", "No. males *No. nests"),
                 row.names = FALSE) %>% 
  kable_styling() %>%
  row_spec(6, hline_after = TRUE) %>%
  row_spec(7, bold = TRUE, background = "#C0C2C9")
```
]

.pull-right[

$$\frac{163}{64} = 2.55$$
]

---
# Typing in data, calcs, plots

## Finding the mean


Find the total number of nests
```{r}
# total number of nests
total_nests <- sum(freq)
```
 
--

Find the total number of males
```{r}
# total number of males
total_males <- sum(n * freq)
```

--

Find the mean number of males per nest
```{r}
# mean number males/nest
total_males/total_nests
```


---
# Typing in data, calcs, plots

## Finding the mean


R works 'elementwise' unlike most programming lanaguges.  
` n * freq`
gives

$$\begin{bmatrix}0\\1\\2\\3\\4\\5\end{bmatrix}\times\begin{bmatrix}4\\13\\14\\15\\13\\5\end{bmatrix}=\begin{bmatrix}0\\13\\28\\45\\52\\25\end{bmatrix}$$

It was designed to make it easy to work with data.


---
background-image: url(../pics/ggplot2.png)
background-position: 90% 65%
background-size: 200px

# Typing in data, calcs, plots

## Plotting using `ggplot2`

Commands like `c()`, `sum()`, and `str()` are part the 'base' R system.

Base packages (collections of commands) always come with R. 

--

Other packages, such as `ggplot2` `r Cite(myBib, "ggplot2")`<sup>1</sup> need to be added.

`ggplot2` is one of the `tidyverse` `r Cite(myBib, "tidyverse")` packages.

.footnote[
[1] A fantastic plotting system which has a common conceptual framework for visualisation based on [The Grammar of Graphics](https://www.amazon.com/Grammar-Graphics-Statistics-Computing/dp/0387245448/ref=as_li_ss_tl?ie=UTF8&qid=1477928463&sr=8-1&keywords=the+grammar+of+graphics&linkCode=sl1&tag=ggplot2-20&linkId=f0130e557161b83fbe97ba0e9175c431)
]

---
background-image: url(../pics/tidyverse.png)
background-position: 90% 65%
background-size: 200px
# Typing in data, calcs, plots

## Plotting using `ggplot2`

You should have already installed `tidyverse` but we need to load it (add it to our library) before we can use it in a session.

```{r eval=FALSE}
library(tidyverse)
```

--

We will also later use `dplyr` and `tidyr` functions also from `tidyverse`.


## `ggplot2` or `ggplot()`?

`ggplot2` is the name of the package

`ggplot()` is its most important command


---
# Plotting using ggplot2

## Data structure needed for `ggplot()` 

`ggplot()` takes a dataframe for an argument

We need to make one from `n` and `freq`. We will turn `n` into a factor (a categorical variable).

```{r}
nest_data <- data.frame(n = factor(n), freq)
```

--
And check
```{r}
str(nest_data)
```

--

`nest_data` is just a name we have given the dataframe

Click on `nest_data` in the Environment pane to see a spreadsheet-like view of it.

---
# Plotting using ggplot2

## A barplot

Create a simple barplot using `ggplot` like this:

```{r}
ggplot(data = nest_data, aes(x = n, y = freq)) +
  geom_col()

```


---
# Plotting using ggplot2

## A barplot

`ggplot()` alone creates a blank plot. 

--

`ggplot(data = nest_data)` looks the same. 

--

`aes()` gives the 'Aesthetic mappings'. How variables (columns) are mapped to visual properties (aesthetics) e.g., axes, colour, shapes.

--

`ggplot(data = nest_data, aes(x = n, y = freq))` produces a plot with axes 

--

`geom_col` A 'Geom' (Geometric object) gives the visual representations of the data: points, lines, bars, boxplots etc.

---

class: inverse

# Using the help manual

---
# Using the help manual

'Arguments' can be added to the `geom_col()` command.  

Commands do something with/to an object and their arguments can specify:
* what object to do it to  
* how exactly to do it  

--

Many commands have defaults so you need only supply an object.

--

Open the manual page using:
```{r eval=FALSE}
?geom_col()
```

## demonstration
---
# Using the help manual

## Key points

* **Description** an overview of what the command does  

* **Usage** lists argument    
  * format: argument name = default value  
  * some arguments MUST be supplied, they have no defaults
  * ... essentially, etc

* **Arguments** gives the detail on how the arguments work

* **Details** decribes how the command works in more detial  

* **Value** gives the output of the command 

* Don't be too perturbed by not fully understanding the information

---
# Using the help manual

## Altering a ggplot

We can change the fill of the bars using `fill`:
```{r plot-last, fig.show = 'hide'}
ggplot(data = nest_data, aes(x = n, y = freq)) +
  geom_col(fill = "lightblue")

```
.pull-left[
```{r ref.label = 'plot-last', echo = FALSE}
```
]
--
.pull-right[
Colours can be given by their name: "lightblue" 

Or by their hexadecimal code: "#ADD8E6".  

You can look these up as follows:  

[By colour name](../pics/colournames.pdf)

[By hexadecimal code](../pics/colourhex.pdf)

]

---
# Using the help manual

## Altering a ggplot

`fill` is an aesthetic. We can set the fill aesthetic to a particular colour inside `geom_col()` but we can also map it to a variable inside the `aes()` instead: 
```{r eval=FALSE}
ggplot(data = nest_data, aes(x = n, y = freq, fill = n)) +
  geom_col()

```
.pull-left[
```{r fig.width=4,fig.height=4, echo=FALSE}
ggplot(data = nest_data, aes(x = n, y = freq, fill = n)) +
  geom_col()

```
]
--
.pull-right[

Mapping fill to variable means the colour is variable - you get a different colour for each value of n. Not useful here but is when you have another variable.
]
---
# Using the help manual

## Altering a ggplot

Can you use the manual to put the bars next to each other?
.pull-right[
.footnote[
`r kableExtra::text_spec("Extra exercise:", background = "#25496b", color = "#f6fafd", bold = TRUE)`  Can you use the manual to change to colour of the lines around each bar to black?]]
--

```{r}
ggplot(data = nest_data, aes(x = n, y = freq)) +
  geom_col(fill = "lightblue", width = 1)
```


---

# Using the help manual

## Altering a ggplot


`r kableExtra::text_spec("Extra exercise:", background = "#25496b", color = "#f6fafd", bold = TRUE)`  Can you use the manual to change to colour of the lines around each bar to black?

.pull-left[
```{r plot-last2, fig.show="hide"}
ggplot(data = nest_data,
       aes(x = n, y = freq)) +
  geom_col(fill = "lightblue", 
           width = 1, 
           colour = "black")
```
]

.pull-right[
```{r ref.label = 'plot-last2', echo = FALSE}
```
]
---
# Top Tip

<style>
div.blue { background-color:#b0cdef; border-radius: 5px; padding: 20px;}
div.grey { background-color:#d3d3d3; border-radius: 0px; padding: 0px;}
</style>

<div class = "blue">

.font130[
Make your code easier to read by using white space and new lines  

* put spaces around `=` , `->` and after `,`  
* use a newline after every comma in a command with lots of arguments  
]
</div>

---
# Plotting using ggplot2

## Altering the axes. 
Changes to a discrete x axis can be made by adding a `scale_x_discrete()`.

Changes to a continuous y axis can be made by adding a `scale_y_continuous()`.

`ggplot` automatically extends the axes slightly to make sure there is room for points to plot. 
You can turn this behaviour off with the expand argument.

--

Each 'layer' is added to the ggplot() command with a `+`

---
# Plotting using ggplot2

```{r}
ggplot(data = nest_data,
       aes(x = n, y = freq)) +
  geom_col(fill = "lightblue", 
           width = 1, 
           colour = "black") +
  scale_x_discrete(expand = c(0, 0)) + #<<
  scale_y_continuous(expand = c(0, 0)) #<<
```

.pull-right[
.footnote[
`r kableExtra::text_spec("Extra exercise:", background = "#25496b", color = "#fdf9f6", bold = TRUE)`  Look up `scale_x_discrete` in the manual and work out how to change "n" to "Number of Males"]
]

---
# Plotting using ggplot2

```{r}
ggplot(data = nest_data,
       aes(x = n, y = freq)) +
  geom_col(fill = "lightblue", 
           width = 1, 
           colour = "black") +
  scale_x_discrete(expand = c(0, 0),
                   name = "Number of Males") + #<<
  scale_y_continuous(expand = c(0, 0),
                     name = "Number of Nests") 

```

---

class: inverse

# Working with Data


---
# Working with Data

## The goal

```{r echo=FALSE}
pigeon <- read.table("../data/pigeon.txt", header = T)
pigeon2 <- gather(data = pigeon, 
                  key = population, 
                  value = distance)
sumpig <- pigeon2 %>%
  group_by(population) %>% 
  summarise(n = length(distance),
            mean = mean(distance),
            se = sd(distance)/sqrt(n))
sumpig %>% 
    kable(format = "html",
                 col.names = c("Population",
                               "N", 
                               "Mean",
                               "SE"),
                 row.names = FALSE) %>%
  add_header_above(c(" " = 2, " Interorbital distance" = 2))

```

```{r echo=FALSE}
ggplot(data = pigeon2, aes(x = distance, fill = population))  +
  geom_density(col = "black", alpha = 0.3) +
  xlab("Interorbital distance (mm)") +
  theme_classic()
```

---
background-image: url(../pics/interorbital.png)
background-position: 100% 0%
background-size: 180px

# Working with Data 
 
## Importing

This section will teach you about three concepts:

--

1. 'working directories', 'paths' and  'relative paths' 

--

2. Tidy data

--

3. dealing with data in more than group  

--

We will work with the interorbital distances of domestic pigeons in two different populations: A and B

---
background-image: url(../pics/interorbital.png)
background-position: 100% 0%
background-size: 180px

# Working with Data 
## Importing

It is good practice to organise your files into a folder structure. 

For example, I often use:

![a folder called stemcells with 4 subfolders - figures, processed data, raw data and scripts](../pics/dir_structure.png)

---
background-image: url(../pics/interorbital.png)
background-position: 100% 0%
background-size: 180px

# Working with Data 
## Importing
<br>
Make a folder in your Project directory (this is also your working directory) called 'data'

The easiest way to do this is in RStudio  - see the bottom right Files panel

--

Save a copy of [pigeon.txt](../data/pigeon.txt) to the 'data' folder


---
background-image: url(../pics/interorbital.png)
background-position: 100% 0%
background-size: 180px

# Working with Data 
## Importing


To read the data in to R you need to use the 'relative path'

to the file in the `read.table()` command:


```{r}
pigeon <- read.table("../data/pigeon.txt", header = TRUE)
```



--

The `data/` part is the 'relative path' to the file. 

--

It says where the file is **relative to your working directory**

pigeon.txt is inside a folder (directory) called 'data' which is in your working directory.

---
background-image: url(../pics/interorbital.png)
background-position: 100% 0%
background-size: 180px

# Working with Data 
## Importing

Look at the structure of the dataframe pigeon using `str()`

```{r }
str(pigeon)
```
--

It's a dataframe with two variables (columns) called A and B

The datatype of both variables is numeric.
---
background-image: url(../pics/interorbital.png)
background-position: 100% 0%
background-size: 180px

# Working with Data

## Understanding the dataframe
A dataframe is made of columns and rows

The columns are the variables; the rows are the observations

--

To refer a column inside a dataframe (a single column data) we need to use the dollar notation: `dataframe$columnname`

--

So to output all of the values of one column we can use:
```{r}
pigeon$A
```



---
background-image: url(../pics/interorbital.png)
background-position: 100% 0%
background-size: 180px


# Working with Data

## Summarising multi-group data

### Find the mean for each population. 

Remember, to refer a column inside a dataframe (a single column data) we need to use the dollar notation: `dataframe$columnname`

--
.pull-left[
The mean of column $A

```{r }
mean(pigeon$A)
```

The mean of column $B

```{r }
mean(pigeon$B)
```
]
.pull-right[

This relies on the groups being in different columns!

]
---
background-image: url(../pics/interorbital.png)
background-position: 100% 0%
background-size: 180px

# Working with Data 

## Tidy format


Instead of having a population in each column, we very often

have, **and want**, data organised so the measurements are all

in one column and a second column gives the group. 

--

This format is described as 'tidy' `r Cite(myBib, "Wickham2019-ml")`.


--

Tidy data has a variable in each column and only one observation (case) per row.

--

The format captures the structure of your data and allows you to specify the role of variables in analyses and visualisations.


---
background-image: url(../pics/interorbital.png)
background-position: 100% 0%
background-size: 180px

# Working with Data 

## Tidy format

.pull-left[

Tidy data has a variable in each column and only one observation (case) per row.

Suppose we had just 3 individuals in each population:


**NOT TIDY!**
```{r echo=FALSE}
knitr::kable(pigeon[1:3,], 
             format = "html")
```
]
```{r echo=FALSE}
pigeon2 <- gather(data = pigeon, 
                  key = population, 
                  value = distance)
```

.pull-right[
<br>
<br>
<br>

**TIDY!**
```{r echo=FALSE}
knitr::kable(head(pigeon2[c(1:3,41:43),]), 
             format = "html",
             row.names = FALSE)
```
]


---
background-image: url(../pics/interorbital.png)
background-position: 100% 0%
background-size: 180px

# Working with Data 
## Tidy format

We can make the data tidy with `pivot_longer()`<sup>1</sup>.

`pivot_longer()` collects the values from specified columns (`cols`) into a single column (`values_to`) and creates a column to indicate the group (`names_to`). 

.footnote[
[1] `pivot_longer()` is a function from a package called `tidyr` which is one of the `tidyverse` packages.
]

--

```{r}

pigeon2 <- pivot_longer(data = pigeon, 
                        cols = everything(), 
                        names_to = "population", 
                        values_to = "distance")
str(pigeon2)
```

&nbsp;
&nbsp;



---
background-image: url(../pics/interorbital.png)
background-position: 100% 0%
background-size: 180px

# Working with Data 

## Summarising multi-group data
<br>
Now we have a dataframe in tidy format which *will* make it easier to summarise, analyse and visualise.

--

To summarise data in this format we use the `group_by()` and `summarise()` functions.

--

We will also use the pipe operator: ` %>% `

---
background-image: url(../pics/interorbital.png)
background-position: 100% 0%
background-size: 180px

# Working with Data 

## Summarising multi-group data
.pull-left[
```{r}
pigeon2 %>% 
  group_by(population) %>% 
  summarise(mean = mean(distance))
```

]
--

.pull-right[


This can be read as:  
  - take pigeon2 *and then*  
  - group it by population *and then*  
  - summarise it by calculating the mean  

i.e., the mean is done for each population.
]

--

the `mean` before the `=` is just a name.

---
background-image: url(../pics/interorbital.png)
background-position: 100% 0%
background-size: 180px

# Working with Data 

## Summarising multi-group data

We can add the number of pigeons in each group to the summary using the `length()` function.

```{r}
pigeon2 %>% 
  group_by(population) %>% 
  summarise(mean = mean(distance),
            n = length(distance)) #<<
```

.footnote[
`r kableExtra::text_spec("Extra exercise:", background = "#25496b", color = "#fdf9f6", bold = TRUE)`  Add a column for the standard deviation

`r kableExtra::text_spec("Extra exercise:", background = "#25496b", color = "#fdf9f6", bold = TRUE)`  Add a column for the standard error given by $\frac{s.d.}{\sqrt{n}}$

]
---
background-image: url(../pics/interorbital.png)
background-position: 100% 0%
background-size: 180px

# Working with Data 

## Summarising multi-group data
<br>
```{r}
pigeon2 %>% 
  group_by(population) %>% 
  summarise(mean = mean(distance),
            n = length(distance),
            sd = sd(distance), #<<
            se = sd/sqrt(n))   #<<
```

---
background-image: url(../pics/interorbital.png)
background-position: 100% 0%
background-size: 180px

# Working with Data 

## Plotting multi-group data

```{r plot-last3, fig.show = 'hide'}
ggplot(data = pigeon2, aes(x = distance)) +
  geom_histogram(bins = 10,               #<<
                 col = "black") +
  scale_x_continuous(name = "Interorbital distance (mm)")
  
```
.pull-left[

```{r ref.label = 'plot-last3', echo = FALSE}
```
]

--
.pull-right[

The geom we have used this time is a `geom_histogram()`.

`bins` is the the number of bars you get.

We have the whole data set without separating the populations

]

---
background-image: url(../pics/interorbital.png)
background-position: 100% 0%
background-size: 180px

# Working with Data 

## Plotting multi-group data

We can use the `aes()` to 'map' the population variable to the `fill` aesthetic

```{r}
ggplot(data = pigeon2, aes(x = distance, fill = population)) + #<<
  geom_histogram(bins = 10, 
                 col = "black") +
  scale_x_continuous(name = "Interorbital distance (mm)")
  
```
.pull-right[
.footnote[
`r kableExtra::text_spec("Extra exercise:", background = "#25496b", color = "#fdf9f6", bold = TRUE)`  Can you remember how to make the axes cross at (0,0)]
]
---
background-image: url(../pics/interorbital.png)
background-position: 100% 0%
background-size: 180px

# Working with Data 

`r kableExtra::text_spec("Extra exercise:", background = "#25496b", color = "#fdf9f6", bold = TRUE)`  Can you remember how to make the axes cross at (0,0)

```{r}
ggplot(data = pigeon2, aes(x = distance, fill = population)) + #<<
  geom_histogram(bins = 10, 
                 col = "black") +
  scale_x_continuous(name = "Interorbital distance (mm)",
                     expand = c(0, 0)) +
  scale_y_continuous(name = "Frequency",
                     expand = c(0, 0))
  
  
```


---
background-image: url(../pics/interorbital.png)
background-position: 100% 0%
background-size: 180px

# Working with Data 

## Plotting multi-group data

`geom_density()` is another `geom` that can be used when `distance` is mapped to `x` and the y axis gives counts.

```{r}
ggplot(data = pigeon2, aes(x = distance, fill = population)) +
  geom_density(col = "black") +               #<<
  scale_x_continuous(name = "Interorbital distance (mm)")
  
```

---
background-image: url(../pics/interorbital.png)
background-position: 100% 0%
background-size: 180px

# Working with Data 

## Plotting multi-group data

We can alter the transparancy using `alpha`


```{r}
ggplot(data = pigeon2, aes(x = distance, fill = population)) +
  geom_density(col = "black", alpha = 0.3) +    #<<
  scale_x_continuous(name = "Interorbital distance (mm)")
  
```

---
background-image: url(../pics/interorbital.png)
background-position: 100% 0%
background-size: 180px

# Working with Data 

## Plotting multi-group data

We often want to format figures for inclusion in reports. 

All [elements can be customised individually](https://ggplot2.tidyverse.org/reference/theme.html) but `theme_classic()` takes care of many options you are likely to desire.

---
background-image: url(../pics/interorbital.png)
background-position: 100% 0%
background-size: 180px

# Working with Data 

## Plotting multi-group data

```{r}
ggplot(data = pigeon2, aes(x = distance, fill = population)) +
  geom_density(col = "black", alpha = 0.3) +
  scale_x_continuous(name = "Interorbital distance (mm)") +
  theme_classic()    #<<
  
```

---
background-image: url(../pics/interorbital.png)
background-position: 100% 0%
background-size: 180px

# Working with Data 

## Plotting multi-group data

### A different kind of plot

.pull-left[
```{r echo=FALSE} 
ggplot(data = pigeon2, aes(x = population, y = distance)) + 
  geom_boxplot() +                            
  scale_x_discrete(name = "Population") +
  scale_y_continuous(name = "Interorbital distance (mm)",
                   expand = c(0, 0),
                   limits = c(0, 15)) +
  theme_classic()
  
```
]

.pull-right[

Note: We need to change the `aes()` as well as the `geom` because this figure has population on the x axis.

]
---
# Working with Data 

## Plotting multi-group data

```{r plot-last4, fig.show = 'hide'} 
ggplot(data = pigeon2, aes(x = population, y = distance)) + 
  geom_boxplot() +                            
  scale_x_discrete(name = "Population") +
  scale_y_continuous(name = "Interorbital distance (mm)",
                   expand = c(0, 0),
                   limits = c(0, 15)) +
  theme_classic()
  
```

.pull-left[
```{r ref.label = 'plot-last4', echo = FALSE} 
```
]
.pull-right[
.footnote[
`r kableExtra::text_spec("Extra exercise:", background = "#25496b", color = "#fdf9f6", bold = TRUE)`  Can you (gratuitously) colour the boxes by population too?]
]

---
# Summary


* write commands in a script, edit when incorrect  
* comment your scripts  
* use white space and newlines  
* the assignment operator is `<-` (alt-minus)  
* the pipe operator is ` %>%` (ctl-shift-m)  
* objects you're created can be seen in the Environment window  
* data is read in to R from files into dataframes  
* the dataframe is the most commonly used data structure in analysis  
* you'll eventually get used to the manual  
* a `ggplot` has a `data` argument and an `aesthetic` argument; layers are added with a `+`; `geoms`dtermine how the data are plotted  
* `ggplot` makes it easy to transition between plot types  
* Use RStudio projects and organise your analysis into separate folders (more tomorrow)  
* use relative paths (more tomorrow)  


---
# References
.footnote[
Slides made with with xaringan `r Cite(myBib, "xaringan")`

]
```{r refs, echo=FALSE, results="asis"}
PrintBibliography(myBib)  
```



---

class: inverse

# `r emo::ji("party")` Congratulations! Keep practising! `r emo::ji("party")` 

---
# Introduction to Reproducibility in R

## Emma Rand <br> [emma.rand@york.ac.uk](mailto:emma.rand@york.ac.uk) <br> Twitter: [@er13_r](https://twitter.com/er13_r) <br> GitHub: [3mmaRand](https://github.com/3mmaRand)  <br> blog: https://buzzrbeeline.blog/
<br>
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">White Rose BBSRC Doctoral Training Partnership (DTP) in Mechanistic Biology Analytics 1: Introduction to reproducible analyses in R</span> by <span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">Emma Rand</span> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.





