---
title: "Variation in myoglobin content of skeletal muscle of seal species."
author: "Emma Rand"
output:
  bookdown::pdf_document2: default
  bookdown::html_document2: default
  bookdown::word_document2: default
bibliography: reference.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      warning = FALSE,
                      message = FALSE)
```

```{r packages}
library(tidyverse)
```

# Introduction
Aquatic and marine mammals are able to dive underwater for extended periods as a result of having a higher muscle myoglobin concentration than terrestrial mammals [@Kanatous2741]. @NOREN2000181 found that 83% of the variation in Toothed whale species (odontocetes) dive capacity was accounted for by body mass and myoglobin content.
Seal species are also known to vary in dive length. We investigated whether the concentration of myoglobin differed between species.

# Methods
```{r import}
# Data import
# the data are organised in to three columns, one for each species. 
seal <- read_table2("raw_data/seal.txt")
```

```{r tidy}
# put the data in tidy format
seal2 <- seal %>% 
  pivot_longer(names_to = "species",
               values_to = "myoglobin",
               cols = everything())

# write tidy data to processed
write.table(seal2, 
            "processed_data/seal2.txt",
            row.names = FALSE)
```


```{r summarise}
sealsummary <- seal2 %>%
  group_by(species) %>%
  summarise(mean = mean(myoglobin),
            std = sd(myoglobin),
            n = length(myoglobin),
            se = std/sqrt(n))
```

```{r extract}
# extract values for inline reporting

highestmean <- max(sealsummary$mean)
highestse <- sealsummary$se[sealsummary$mean == highestmean]
highestspp <- sealsummary$species[sealsummary$mean == highestmean]
lowestmean <- min(sealsummary$mean)
lowestse <- sealsummary$se[sealsummary$mean == lowestmean]
lowestspp <- sealsummary$species[sealsummary$mean == lowestmean]

```

We measured the myoglobin content of the skeletal muscle of `r sealsummary$N[1]` individuals in each of three species.
We used R [@R-core] with tidyverse packages [@tidyverse] for all analyses.



```{r testing}
mod <- aov(data = seal2, myoglobin ~ species)

# extract values for inline reporting
res <- summary(mod)[[1]]
fval <- round(res$`F value`[1], 2)
df1 <- res$Df[1]
df2 <- res$Df[2]
p <- round(res$`Pr(>F)`[1], 3)
```

```{r posthoc, include=FALSE}
TukeyHSD(mod)
```

# Results
There is a significant difference in myoglobin concentration between species (_F_ = `r fval`; _d.f._ =`r df1`, `r df2`; _p_ = `r p`). Post-hoc testing revealed that difference to be between the `r highestspp` seal with the highest myoglobin concentrations ($\bar{x} \pm s.e.$: `r round(highestmean,2)` $\pm$ `r round(highestse,2)` g Kg^-1^) and the `r lowestspp` seal with the lowest (`r round(lowestmean,2)` $\pm$ `r round(lowestse,2)` g Kg^-1^). See Figure \@ref(fig:myo-fig)


```{r myo-fig, fig.height=4, fig.width=4, fig.cap="Mean Myoglobin content of skeletal muscle"}

ggplot() +
  geom_point(data = seal2, aes(x = species, y = myoglobin),
             position = position_jitter(width = 0.1, height = 0),
             colour = "gray50") +
  geom_errorbar(data = sealsummary, 
                aes(x = species, ymin = mean - se, ymax = mean + se),
                width = 0.3) +
  geom_errorbar(data = sealsummary, 
                aes(x = species, ymin = mean, ymax = mean),
                width = 0.2) +
  scale_y_continuous(name = expression("Myoglobin concentration g "*Kg^{-1}), 
                     limits = c(0, 80), 
                     expand = c(0, 0)) +
  scale_x_discrete(labels = c("Bladdernose", "Harbour", "Weddell"), 
                   name = "Seal Species") +
  annotate("segment", x = 1, xend = 2, 
           y = 72, yend = 72,
           colour = "black") +
  annotate("segment", x = 2, xend = 2, 
           y = 72, yend = 70,
           colour = "black") +
  annotate("segment", x = 1, xend = 1, 
           y = 72, yend = 70,
           colour = "black") +
  annotate("text", x = 1.5,  y = 74, 
           label = "*", size = 8) +
  theme_classic()

```


# References

